<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dry Run Terraform Test - Opción Múltiple</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .config-panel {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .question {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .options label {
            display: block;
            margin: 8px 0;
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
            cursor: pointer;
        }
        .options label:hover {
            background-color: #e9ecef;
        }
        .exam-title {
            text-align: center;
            margin-bottom: 30px;
        }
        .hidden {
            display: none;
        }
        #results {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        .question-type {
            font-style: italic;
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Random question generator</h1>
        
        <div id="configPanel" class="config-panel">
            <h2>Terraform Quiz</h2>
            <label for="numQuestions">Questions (máximo 10):</label>
            <input type="number" id="numQuestions" min="1" max="24" value="10">
            <br>
            <button id="generateBtn">Generate Test</button>
        </div>
        
        <div id="examContainer" class="hidden">
            <div class="exam-title">
                <h2>Knowladge Test</h2>
                <p>Please responde the questions as below:</p>
            </div>
            
            <form id="examForm">
                <!-- Las preguntas se insertarán aquí dinámicamente -->
            </form>
            
            <button id="submitBtn">Send the answers</button>
            <button id="newExamBtn">Generate new Test</button>
            
            <div id="results" class="hidden"></div>
        </div>
    </div>

    <script>
        // Base de datos de preguntas (ahora con diferentes tipos)
        const questionPool = [
            {
                question: "¿Does the terraform state file store sensitive values?",
                options: ["No, input variables are automatically encrypted when stored in the state file.", "Yes, but if you apply sensitive = true sensitive true, the value will be masked in the statefile.", "Yes, it can store sensitive state files, regardless of attributes applied", "No, the statefile does not contain sensitive values from variables."],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿When we need to rename a resource what Terraform command should we use?",
                options: ["teraform rename", "terraform mv", "teraform resource rename", "terraform state mv"],
                correctAnswers: [3], // Solo una respuesta correcta
                type: "multiple" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿When running terraform init, it will do the following?",
                options: ["initial a new terraform cloud remote worksapce", "create a state file", "create a dependency lock file", "create a terraform directory", "dowload plugin dependencies"],
                correctAnswers: [2, 3, 4], // Múltiples respuestas correctas
                type: "multiple" // Tipo de pregunta: múltiples respuestas
            },
            {
                question: "¿When terraform locks its state it creates a dependency lock file called .terraform.lock?",
                options: ["FALSE", "TRUE"], // Solo una respuesta correcta
                correctAnswers: [0], // Tipo de pregunta: una sola respuesta
                type: "Single"
            },
            {
                question: "How can you mark a resource for replacement? (Choose 2)?",
                options: ["terraform apply -replace", "terraform state mv", "terraform resource replace", "terraform replace", "terraform taint"],
                correctAnswers: [0, 4], // Múltiples respuestas correctas
                type: "multiple" // Tipo de pregunta: múltiples respuestas
            },
            {
                question: "What is the scope of Local Values between parent and child modules??",
                options: ["Local values defined in the submodules are accessible to the parent but not between adjacent child modules", "Local values defined in the parent are accessible to all the child modules", "Local values are scoped for the only current module", "Local values in the parent module are only accessible to the parent."],
                correctAnswers: [2], // Múltiples respuestas correctas
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "What is the scope of Local Values between parent and child modules??",
                options: ["terraform apply -replace", "terraform state mv", "Local values are scoped for the only current module", "terraform replace", "terraform taint"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuestA
            },
            {
                question: "terraform plan must be run before perform terraform apply.",
                options: ["TRUE", "FALSE"],
                correctAnswers: [1], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "You would like to reuse the same Terraform configuration for your development and production environments with a different state file for each. Which command would you use?",
                options: ["terraform init", "terraform workspace", "terraform state", "terraform import"],
                correctAnswers: [1], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿Which of the following commands will remove a resource from the state file without destroying it?",
                options: ["terraform destroy -target", "terraform state rm", "terraform remove", "terraform state delete"],
                correctAnswers: [1], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿A developer has deleted a database resource for Google Cloud that was being managed by a terraform state file. What will happen when the developer runs terraform apply -refresh-only??",
                options: ["terraform apply -refresh-only will simply print out to the CLI what has changed", "The deleted database resource will be recreated", "-refresh-only is not an available flag on apply, you need use to terraform refresh", "The state file will be updated to reflect the change of the deleted resource"],
                correctAnswers: [3], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿HashiCorp Configuration Language (HCL) supports user-defined functions. Is this statement true??",
                options: ["TRUE", "FALSE"],
                correctAnswers: [1], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿What type of block is used to construct a collection of nested configuration blocks?",
                options: ["loop", "nesting", "dynamic", "for each"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿What is the primary use of variables in Terraform configurations?",
                options: ["To determine the execution order of resources", "To handle secret injection", "To parameterize configurations and make them reusable", "To connect resources together"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿What is the primary purpose of the backend block configuration in Terraform?",
                options: ["To store and manage the Terraform state in a remote location", "To determine the execution order of resources", "To handle secret injection", "To connect resources together"],
                correctAnswers: [0], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿Which of the following best describes Data Sources in Terraform?",
                options: ["Data to be fetched or computed for use elsewhere in terraform configuration.", "A type of variable that must be declared in the Terraform configuration before use.", "Data sources are a way for terraform to keep track of all resources created in the provider’s infrastructure.", "User-defined codes that get executed every time Terraform initializes."],
                correctAnswers: [0], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿terraform apply ______ will apply changes without requiring user confirmation.",
                options: ["-force", "All of the options", "-auto-approve", "-approve"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿When you want to remove a record tracking a remote object in your state file but have the remote object (eg. Azure Virtual Machine) to still exist, which command do you use?",
                options: ["terraform apply -replace", "terraform resource rm", "terraform state rm", "terraform refresh"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿Which Terraform command should you use to remove all the infrastructure components that were created by your Terraform configuration?",
                options: ["terraform destroy", "terraform init", "terraform apply -auto-approve", "terraform plan -destroy"],
                correctAnswers: [0], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿Which type of block fetches or computes information for use else where in a Terraform configuration?",
                options: ["resource", "local", "data", "provider"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿You are studying Terraform and come across the term Module / Which description best fits the concept of a Terraform module?",
                options: ["A plugin that allows Terraform to interact with a specific cloud provider or service", "A collection of resources that make up a specific piece of infrastructure", "A set of variables used to configure Terraform resources", "A method to specify version constraints for providers"],
                correctAnswers: [1], // Solo una respuesta correctaa
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿You've just started using Terraform to manage your infrastructure. After running terraform apply, you want to check the state of your infrastructure. Which file would you look for to find the current state of your resources?",
                options: ["terraform.config", "terraform.tfstate", "terraform.tfvars", "terraform.state"],
                correctAnswers: [1], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿Which of the following best represents a Terraform plugin??",
                options: ["Terraform registry", "Terraform provider", "Terraform workspaceerraform.tfvars", "Terraform module"],
                correctAnswers: [1], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },
            {
                question: "¿You want to store details about a server, specifically its name (a string) and memory size (a number). Which variable type is most suitable??",
                options: ["map", "set", "object", "list"],
                correctAnswers: [2], // Solo una respuesta correcta
                type: "single" // Tipo de pregunta: una sola respuesta
            },

           
            // ... Agrega aquí las 34 preguntas con este formato
        ];

        // Elementos DOM
        const configPanel = document.getElementById('configPanel');
        const examContainer = document.getElementById('examContainer');
        const examForm = document.getElementById('examForm');
        const generateBtn = document.getElementById('generateBtn');
        const submitBtn = document.getElementById('submitBtn');
        const newExamBtn = document.getElementById('newExamBtn');
        const resultsDiv = document.getElementById('results');
        const numQuestionsInput = document.getElementById('numQuestions');

        // Generar examen aleatorio
        generateBtn.addEventListener('click', () => {
            const numQuestions = parseInt(numQuestionsInput.value);
            
            if (numQuestions > questionPool.length) {
                alert(`No hay suficientes preguntas en el pool. Máximo disponible: ${questionPool.length}`);
                return;
            }
            
            // Seleccionar preguntas aleatorias
            const selectedQuestions = getRandomQuestions(numQuestions);
            
            // Generar HTML para las preguntas
            examForm.innerHTML = '';
            selectedQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                // Determinar el tipo de input según el tipo de pregunta
                const inputType = q.type === 'multiple' ? 'checkbox' : 'radio';
                const typeText = q.type === 'multiple' ? '(Selecciona todas las opciones correctas)' : '(Selecciona una opción)';
                
                questionDiv.innerHTML = `
                    <p><strong>${index + 1}. ${q.question}</strong></p>
                    <div class="question-type">${typeText}</div>
                    <div class="options">
                        ${q.options.map((option, i) => `
                            <label>
                                <input type="${inputType}" name="question${index}" value="${i}">
                                ${option}
                            </label>
                        `).join('')}
                    </div>
                `;
                
                examForm.appendChild(questionDiv);
            });
            
            // Mostrar examen y ocultar panel de configuración
            configPanel.classList.add('hidden');
            examContainer.classList.remove('hidden');
            resultsDiv.classList.add('hidden');
        });

        // Obtener preguntas aleatorias
        function getRandomQuestions(num) {
            // Copiar el array de preguntas
            const shuffled = [...questionPool];
            // Aleatorizar el orden
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            // Devolver el número solicitado
            return shuffled.slice(0, num);
        }

        // Calcular resultados
        submitBtn.addEventListener('click', () => {
            const selectedQuestions = examForm.querySelectorAll('.question');
            let score = 0;
            let resultsHTML = '<h3>Resultados:</h3><ol>';
            
            selectedQuestions.forEach((questionDiv, index) => {
                // Encontrar la pregunta correspondiente en el pool
                const questionText = questionDiv.querySelector('strong').textContent.replace(`${index + 1}. `, '');
                const questionData = questionPool.find(q => q.question === questionText);
                
                // Obtener las respuestas seleccionadas por el usuario
                const selectedOptions = Array.from(questionDiv.querySelectorAll('input:checked')).map(input => parseInt(input.value));
                
                if (selectedOptions.length > 0) {
                    // Verificar si las respuestas son correctas
                    const isCorrect = arraysEqual(selectedOptions.sort(), questionData.correctAnswers.sort());
                    
                    if (isCorrect) {
                        score++;
                        resultsHTML += `<li>Correcto! 👍</li>`;
                    } else {
                        // Mostrar respuestas correctas
                        const correctOptions = questionData.correctAnswers.map(i => questionData.options[i]).join(', ');
                        resultsHTML += `<li>Incorrecto. Las respuestas correctas eran: "${correctOptions}" 👎</li>`;
                    }
                } else {
                    // Mostrar respuestas correctas para preguntas no respondidas
                    const correctOptions = questionData.correctAnswers.map(i => questionData.options[i]).join(', ');
                    resultsHTML += `<li>No respondida. Las respuestas correctas eran: "${correctOptions}"</li>`;
                }
            });
            
            resultsHTML += `</ol><p><strong>Puntuación: ${score} de ${selectedQuestions.length}</strong></p>`;
            resultsDiv.innerHTML = resultsHTML;
            resultsDiv.classList.remove('hidden');
        });

        // Función para comparar si dos arrays son iguales
        function arraysEqual(a, b) {
            if (a.length !== b.length) return false;
            for (let i = 0; i < a.length; i++) {
                if (a[i] !== b[i]) return false;
            }
            return true;
        }

        // Generar nuevo examen
        newExamBtn.addEventListener('click', () => {
            examContainer.classList.add('hidden');
            configPanel.classList.remove('hidden');
        });
    </script>
</body>
</html>
